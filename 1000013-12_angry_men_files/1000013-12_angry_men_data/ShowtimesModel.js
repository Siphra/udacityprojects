define(["jquery","globals","backbone"],function(e,t,i){var s={};return s.ShowtimesQueryModel=i.Model.extend({getDateFormat:function(e){if(e instanceof Date){var t=e.getDate(),i=e.getMonth()+1,s=e.getFullYear();return t<10&&(t="0"+t),i<10&&(i="0"+i),""+s+i+t}return e},defaults:function(){var e=new Date;return{limit:20,hiddenMovieIds:[],allDisplayedMovieIds:[],allTheaterIds:[],selectedMovieIds:[],selectedTheaterIds:[],date:this.getDateFormat(e),location:{},deviceType:"RTO",refresh:!0}},initialize:function(e){e=e||{},this.limitMax=50,this.changeAttributes(e)},changeAttributes:function(e){if(e.hasOwnProperty("zip")&&this.set("zip",e.zip),e.hasOwnProperty("date")&&this.set("date",e.date),e.hasOwnProperty("movies"))for(var t in e.movies)this.putSelectedMovieId(e.movies[t]);if(e.hasOwnProperty("theaters"))for(var i in e.theaters)this.putSelectedTheaterId(e.theaters[i]);e.hasOwnProperty("limit")&&((e.limit>this.limitMax||e.limit<0)&&(e.limit=this.limitMax),this.set("limit",e.limit)),e.hasOwnProperty("location")&&this.set("location",e.location)},resetLimit:function(){this.set("limit",20)},isTheaterSelected:function(){return this.get("selectedTheaterIds").length>0},isMovieSelected:function(){return this.get("selectedMovieIds").length>0},isLimitMaximum:function(){return this.get("limit")>=this.limitMax},pushIfNotExists:function(t,i){return e.inArray(t,i)<0&&(i.push(t),!0)},removeIfExists:function(t,i){var s=e.inArray(t,i);return s>=0&&(i.splice(s,1),!0)},putDisplayedMovieId:function(e){this.removeIfExists(e,this.get("hiddenMovieIds")),this.pushIfNotExists(e,this.get("allDisplayedMovieIds"))},removeDisplayedMovieId:function(e){this.pushIfNotExists(e,this.get("hiddenMovieIds")),this.removeIfExists(e,this.get("allDisplayedMovieIds"))},putSelectedMovieId:function(e){this.pushIfNotExists(Number(e),this.get("selectedMovieIds"))},putSelectedTheaterId:function(e){this.pushIfNotExists(Number(e),this.get("selectedTheaterIds"))},removeSelectedMovieId:function(e){this.removeIfExists(Number(e),this.get("selectedMovieIds"))},removeSelectedTheaterId:function(e){this.removeIfExists(Number(e),this.get("selectedTheaterIds"))},clearAllSelectedTheaterIds:function(e){this.set("selectedTheaterIds",[])},clearAllSelectedMovieIds:function(){this.set("selectedMovieIds",[])},getActiveTheaterList:function(){return this.get("selectedTheaterIds").length>0?this.get("selectedTheaterIds"):this.get("allTheaterIds")},getQueryString:function(){var e={},t=this.get("location");return e.showtimes=!0,e.latitude=t.latitude,e.longitude=t.longitude,e.date=this.get("date"),e.vanityPlatform="RTO",e.fullMovieInfo=!0,e.deviceType=this.get("deviceType"),e.limit=this.get("limit"),e}}),s.MovieList=i.Collection.extend({model:i.Model}),s.MovieListCollection=i.Model.extend({url:function(){return t.ShowtimesHost+"/api/v2/showtimes/getMovies"},initialize:function(e){this.set("openingList",new s.MovieList),this.set("topBoxOfficeList",new s.MovieList)},parse:function(e){e.hasOwnProperty("opening")&&e.opening.length>0&&this.set("openingList",new i.Collection(e.opening)),e.hasOwnProperty("topBoxOffice")&&e.topBoxOffice.length>0&&this.set("topBoxOffice",new i.Collection(e.topBoxOffice))},getOpeningMovieData:function(e){var t=this.get("openingList");for(var i in t.models){var s=t.at(i),o=_.find(s.get("movies"),function(t){return t.id===e});if(o)return{isoDate:t.at(i).get("isoDate"),id:o.id,title:o.title}}}}),s.TheaterData=i.Model.extend({url:function(){return t.ShowtimesHost+"/api/v2/ticketing/theaters"},initialize:function(e){e=e||{},this.favorFlixster=e.favorFlixster},parse:function(e){if(e.hasOwnProperty("traits")&&this.set("traits",new i.Model(e.traits)),e.hasOwnProperty("presentations")&&this.set("presentations",new i.Model(e.presentations)),e.hasOwnProperty("movies")){var t=new i.Collection;for(var s in e.movies)t.add(new i.Model(e.movies[s]),{at:s});this.set("movies",t)}if(e.hasOwnProperty("theaterGroups")){if(this.favorFlixster)for(var o=0;o<e.theaterGroups.length;++o){for(var r=new Array,n=new Array,a=0;a<e.theaterGroups[o].theaters.length;++a)"FLX"==e.theaters[e.theaterGroups[o].theaters[a]].ticketSource?r.push(e.theaterGroups[o].theaters[a]):n.push(e.theaterGroups[o].theaters[a]);e.theaterGroups[o].theaters=r.concat(n)}this.set("theaterGroups",new i.Collection(e.theaterGroups))}if(e.hasOwnProperty("theaters")){for(var h=new i.Collection,l=0,d=0;d<this.get("theaterGroups").length;++d)for(var u=this.get("theaterGroups").at(d).get("theaters"),o=0;o<u.length;++o)h.add(e.theaters[u[o]],{at:l}),++l;this.set("theaters",h)}}}),s});
//# sourceMappingURL=ShowtimesModel.min.js.map