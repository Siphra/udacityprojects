define(["jquery","globals","backbone","marionette","moment","location-utils","bootstrap","jquery-ui"],function(e,t,i,o,n,s){var a={};return a.ShowtimesView=o.ItemView.extend({initialize:function(e){this.template=e.MovieShowtimesTemplate,this.controller=e.controller,this.presentationsView=new Array;var t=this.model.get("theaters").at(0).get("movies")[0],o=t.id,n=this.model.get("movies").get(o);n.set("presentations",new i.Collection(t.presentations)),this.model.get("theaters").at(0).get("movies")[0]=n;for(var s=0;s<n.get("presentations").length;++s)this.presentationsView.push(new e.ShowtimesView.PresentationCompositeView({model:n.get("presentations").at(s),movieId:o,parentModel:this.model,theaterData:this.model.get("theaters").at(0)}));this.locationPicker=new a.LocationPicker({controller:this,el:e.el,isReleased:e.isReleased,movieId:e.movieId,showtimeDate:e.showtimeDate}),this.zipcode=e.zipcode,this.isReleased=e.isReleased,this.showtimeDate=e.showtimeDate},className:"showtimes-presentations",render:function(){_.templateSettings={interpolate:/\<\@\=(.+?)\@\>/gim,evaluate:/\<\@(.+?)\@\>/gim},this.$el=e('<div class="'+this.className+'">'+this.template(this.serializeData())+"</div>"),this.$(".changeLocation").click(this.onChangeLocation.bind(this)),this.$(".movie-showtimes-item").html("");for(var t=0;t<this.presentationsView.length;++t)this.presentationsView[t].render(),this.$(".movie-showtimes-item").append(this.presentationsView[t].$el)},onChangeLocation:function(){this.controller.onChangeLocation()},serializeData:function(){var e=this.model.get("theaters").at(0).toJSON();return e.isReleased=this.isReleased,e.showtimeDateFriendly=n(this.showtimeDate,"YYYYMMDD").format("dddd, MMM D"),e.friendlyPhone=this.phoneToHref(e.phone),e.zip=this.zipcode,e},phoneToHref:function(e){var t=e;return t=t.replace(/[\(,\),\-,\s]/g,"").replace(/\D/g,function(e){for(var t=["ABC","DEF","GHI","JKL","MNO","PQRS","TUV","WXYZ"],i=0;i<t.length;i++)if(t[i].indexOf(e)!=-1)return i+2}),t="+1"+t}}),a.LocationPicker=o.ItemView.extend({events:{"click a":"onChangeLocationClicked",keydown:"filterKey"},initialize:function(e){this.el=e.el,this.controller=e.controller,this.initializeTypeahead()},initializeTypeahead:function(){this.$(".typeahead").autocomplete({appendTo:"#showtimes .showtimesContainer .results",autofocus:!0,source:s.googleMapsAutocompleteSource(),minLength:2,select:function(e,t){s.getLocationFromPlaceId(t.item.placeId).then(function(e){this.applyNewLocation(e)}.bind(this))}.bind(this)}).focus(function(t,i){t.preventDefault(),e("#location-picker #page-title input.typeahead").autocomplete()}).autocomplete("instance"),this.$(".typeahead").keydown(function(e){13==e.keyCode&&this.onEnterValue()}.bind(this))},applyNewLocation:function(e){this.$(".typeahead").val(e.displayName),this.location&&this.location.placeId==e.placeId||(this.location=e,this.controller.onLocationUpdated(e))},onEnterValue:function(){setTimeout(function(){e("#showtimes .showtimesContainer .results .ui-menu-item").size()>0&&e("#showtimes .showtimesContainer .results .ui-menu-item").get(0).click()},500)}}),a});
//# sourceMappingURL=MovieShowtimesView.min.js.map